<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gntour.gangneungyeojido.domain.mytravel.mapper.TravelDiaryMapper">
    <select id="selectAllDiariesByMember" resultType="TravelDiary">
        SELECT * FROM TRAVEL_DIARY
        WHERE MEMBER_ID=#{memberId} ORDER BY DIARY_NO DESC
    </select>
    <select id="selectOneDiaryByMember" resultType="TravelDiary">
        SELECT * FROM TRAVEL_DIARY
        WHERE MEMBER_ID=#{memberId}
    </select>
    <insert id="insertDiary">
        <selectKey resultType="long" keyProperty="diaryNo" order="BEFORE">
            SELECT SEQ_TRAVEL_DIARY_NO.NEXTVAL FROM DUAL
        </selectKey>
        INSERT INTO TRAVEL_DIARY(DIARY_NO, TRAVEL_NO, MEMBER_ID, DIARY_TITLE, DIARY_CONTENT)
        VALUES(#{diaryNo},#{travelNo},#{memberId},#{diaryTitle},#{diaryContent})
    </insert>
    <delete id="deleteDiary">
        DELETE FROM TRAVEL_DIARY WHERE MEMBER_ID = #{memberId}
    </delete>
    <insert id="insertDiaryFile">
        insert into TRAVEL_DIARY_FILE(DIARY_FILE_NO, FILE_PATH, FILE_NAME, FILE_RENAME, DIARY_NO, WEB_PATH, FILE_ORDER)
        values (SEQ_TRAVEL_DIARY_FILE_NO.NEXTVAL, #{filePath}, #{fileName}, #{fileRename}, #{diaryNo}, #{webPath}, #{fileOrder})
    </insert>
    <select id="selectAllDiariesFileByDiaryNo" resultType="TravelDiaryFile">
        SELECT * FROM TRAVEL_DIARY_FILE
        WHERE DIARY_NO = #{diaryNo}
    </select>
    <delete id="deleteDiaryFile">
        delete from TRAVEL_DIARY_FILE WHERE DIARY_NO = #{diaryNo}
    </delete>
</mapper>